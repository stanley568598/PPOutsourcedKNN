-----

## 動機、困難

- treebase
  - 目標：利用 "分群"+"樹狀索引結構"，減少 kNN 計算量，達成 PPkNN 的 加速。
  - 問題：如何取得中心點，建構適合所有查詢資料的 tree？
    - 原始 kNN 使用查詢點作為距離的基準，得出各筆資料和查詢點的距離來進行 kNN。
    - 但今天要在還不確定查詢點下，得出距離，做出 tree，外包到 Server。
  - 結果：(隨機選擇中心點 / 以原始資料平均值為中心點) accuracy 都很低。
    - 尤其是當 中心點 無法明確地分出各 label 距離 (label 距離差異不大)，分類效果極差。

-----

## code

tree 的部分 主要是在 utility 裡面的 tree function 做 分群建樹的動作。

在通過 Client_Server 裡面的 tree_Method 做預測。

-----

## iris

iris dataset：有150筆資料，共四種特徵，分類三種鳶尾花。

| iris test { NUM_DELEGATE = 16 , RADIUS = 0.5 } | ( 1 , 10 ) | ( 16 , 0.5 ) - now case | ( 16 , 0.25 ) | ( 16 , 0.1 ) |
| :-------- | :-------- | :-------- | :-------- | :-------- |
| log 1 | correct：93% , time：0.2sec , groups_size：[120] (ALL) | correct：76% , time：0.033sec , groups_size：[8, 10, 2, 3, 11, 3, 6, 2, 14, 18, 8, 13, 2, 3, 4, 5] | correct：53% , time：0.025sec , groups_size：[1, 2, 1, 7, 1, 2, 2, 2, 1, 2, 2, 8, 1, 2, 1, 1] | correct：60% , time：0.22sec , groups_size：[1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1] |
| log 2 | correct：% , time：sec , groups_size：[] | correct：73% , time：0.035sec , groups_size：[18, 2, 11, 17, 4, 17, 11, 8, 16, 2, 8, 3, 7, 4, 15, 19] | correct：60% , time：0.029sec , groups_size：[1, 2, 1, 2, 3, 3, 2, 1, 1, 1, 1, 1, 1, 5, 3, 2] | correct：60% , time：0.019sec , groups_size：[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] |
| log 3 |  | correct：76% , time：0.054sec , groups_size：[24, 19, 6, 12, 3, 7, 12, 9, 18, 10, 1, 11, 7, 7, 9, 7] | correct：66% , time：0.027sec , groups_size：[1, 2, 5, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2] | correct：70% , time：0.025sec , groups_size：[2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2] |
| log 4 |  | correct：70% , time：0.037sec , groups_size：[6, 7, 18, 5, 3, 10, 16, 1, 2, 15, 3, 11, 1, 4, 9, 15] | correct：63% , time：0.029sec , groups_size：[9, 3, 1, 1, 1, 1, 8, 1, 1, 6, 4, 2, 1, 3, 2, 2] | correct：80% , time：0.025sec , groups_size：[1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1] |
| log 5 |  | correct：83% , time：0.055sec , groups_size：[11, 12, 12, 12, 4, 6, 2, 3, 21, 14, 7, 18, 19, 10, 12, 7] | correct：76% , time：0.035sec , groups_size：[1, 6, 5, 3, 3, 2, 1, 2, 4, 1, 1, 2, 2, 1, 1, 1] | correct：66% , time：0.027sec , groups_size：[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] |
| total | correct：93% , time：0.2sec , groups_size：[120] (ALL) | correct：70 - 80% , time：0.03 - 0.05sec , groups_size：(5 - 15) | correct：55 - 70% , time：0.025 - 0.035sec , groups_size：(1 - 5) | correct：60 - 80% , time：0.02 - 0.025sec , groups_size：(1 - 2) |

-----

## digits

digits dataset：有1797張影像，影像大小為8x8，64個元素之一維向量，分類 ( 0  -  9 ) 10個數字。

| digits test { NUM_DELEGATE = 1 , RADIUS = 100 } | ( 1 , 100 ) | ( 5 , 50 ) | ( 10 , 50 ) | ( 100 , 50 )| ( 5 , 40 ) |  ( 10 , 40 ) | ( 100 , 40 )  | ( 100 , 30 ) | ( 100 , 20 ) - now case | ( 1000 , 10 ) |
| :-------- | :-------- | :-------- | :-------- | :-------- | :-------- | :-------- | :-------- | :-------- | :-------- | :-------- |
| log 1 | correct：98% , time：266sec , groups_size：[1473] (ALL) | correct：32% , time：53sec , groups_size：[1268 , 680 , 309 , 285 , 587] | correct：71% , time：63sec , groups_size：[764, 629, 630, 676, 634, 1139, 660, 644, 485, 346] | correct：62% , time：46sec , groups_size：[873, 618, 626, 736, 885, 489, 896, 659, 702, 602, 582, 1187, 975, 524, 494, 682, 917, 415, 495, 519, 766, 1053, 538, 619, 657, 636, 1002, 553, 1019, 741, 535, 767, 1174, 742, 751, 932, 713, 679, 700, 932, 695, 715, 703, 779, 953, 985, 838, 633, 773, 767, 956, 1134, 630, 821, 896, 959, 598, 571, 1083, 864, 967, 1183, 770, 851, 855, 836, 919, 677, 825, 1089, 837, 687, 839, 1024, 1038, 471, 664, 701, 779, 1173, 723, 591, 1079, 892, 553, 605, 586, 247, 603, 701, 968, 671, 1030, 661, 919, 926, 810, 971, 826, 1220] | correct：27% , time：8sec , groups_size：[191, 284, 98, 37, 242] | correct：15% , time：6sec , groups_size：[25, 217, 315, 124, 293, 131, 185, 245, 149, 110] | correct：24% , time：10sec , groups_size：[446, 183, 157, 214, 47, 61, 148, 248, 133, 185, 162, 187, 206, 306, 237, 128, 162, 245, 169, 225, 157, 46, 159, 116, 284, 151, 219, 216, 143, 310, 97, 311, 203, 119, 161, 154, 110, 360, 251, 189, 271, 220, 188, 198, 184, 343, 198, 288, 266, 225, 271, 126, 60, 181, 240, 115, 152, 301, 97, 208, 87, 247, 193, 223, 206, 104, 112, 407, 156, 197, 158, 224, 235, 142, 173, 66, 317, 230, 211, 257, 335, 249, 173, 365, 259, 132, 63, 285, 225, 143, 184, 298, 318, 196, 248, 348, 320, 170, 47, 197] | correct：12% , time：7sec , groups_size：[58, 8, 2, 120, 35, 13, 62, 42, 63, 52, 29, 48, 36, 66, 19, 58, 65, 26, 49, 57, 49, 57, 4, 54, 11, 59, 23, 46, 30, 5, 33, 95, 97, 22, 16, 6, 6, 37, 31, 52, 40, 50, 56, 73, 112, 23, 40, 104, 38, 85, 21, 10, 26, 58, 84, 33, 14, 86, 46, 22, 57, 9, 39, 85, 18, 103, 48, 36, 15, 15, 33, 39, 15, 30, 44, 41, 35, 26, 81, 26, 7, 64, 52, 31, 36, 36, 21, 75, 16, 32, 35, 98, 51, 22, 82, 47, 113, 8, 46, 43] | correct：13% , time：3sec , groups_size：[3, 14, 4, 3, 6, 8, 25, 3, 5, 6, 2, 2, 17, 2, 4, 11, 6, 5, 3, 5, 6, 4, 4, 13, 8, 14, 2, 4, 7, 13, 10, 1, 12, 14, 10, 1, 1, 4, 1, 5, 3, 1, 3, 2, 10, 14, 6, 2, 3, 4, 7, 9, 5, 2, 7, 18, 1, 3, 7, 11, 1, 5, 1, 8, 3, 6, 6, 11, 5, 10, 14, 2, 3, 1, 2, 3, 4, 2, 6, 7, 3, 12, 1, 3, 1, 4, 5, 3, 19, 4, 2, 7, 2, 8, 6, 3, 22, 3, 4, 13] | correct：16% , time：2sec , groups_size：[1, ... , 1] |
| log 2 | correct：% , time：sec , groups_size：[] | correct：86% , time：91sec , groups_size：[891 , 858 , 494 , 625 , 735] | correct：63% , time：82sec , groups_size：[732, 885, 849, 974, 599, 471, 832, 1188, 455, 555] | correct：63% , time：46sec , groups_size：[755, 829, 1215, 953, 255, 777, 1075, 914, 732, 976, 885, 711, 955, 876, 568, 919, 904, 620, 526, 752, 658, 477, 323, 1062, 1029, 826, 877, 781, 405, 303, 383, 591, 690, 952, 965, 741, 727, 625, 523, 893, 760, 951, 981, 705, 1069, 756, 910, 973, 783, 1150, 488, 913, 671, 733, 649, 610, 932, 870, 542, 804, 893, 894, 742, 720, 862, 664, 707, 983, 718, 580, 926, 722, 703, 923, 999, 687, 611, 783, 789, 1020, 739, 895, 908, 829, 712, 817, 1014, 595, 775, 904, 855, 1024, 1074, 510, 595, 928, 871, 736, 789, 983] | correct：18% , time：33sec , groups_size：[220, 167, 179, 121, 105] | correct：22% , time：17sec , groups_size：[128, 84, 302, 81, 89, 128, 196, 112, 89, 192] | correct：26% , time：14sec , groups_size：[99, 50, 141, 232, 183, 62, 225, 152, 223, 116, 238, 151, 200, 82, 155, 245, 168, 343, 340, 161, 224, 392, 234, 201, 221, 126, 293, 239, 101, 317, 252, 269, 216, 187, 41, 285, 365, 162, 184, 223, 187, 292, 336, 268, 115, 128, 216, 229, 49, 366, 364, 156, 153, 175, 244, 305, 302, 272, 342, 207, 196, 223, 379, 407, 150, 192, 110, 92, 202, 238, 130, 237, 198, 93, 278, 145, 205, 322, 128, 69, 332, 125, 162, 153, 244, 261, 198, 129, 191, 305, 106, 239, 342, 350, 352, 314, 100, 189, 38, 135] | correct：10% , time：6sec , groups_size：[22, 10, 31, 21, 11, 19, 7, 60, 48, 124, 29, 131, 5, 66, 117, 11, 24, 43, 28, 12, 33, 22, 22, 80, 128, 25, 12, 81, 29, 11, 54, 121, 60, 24, 45, 31, 48, 31, 10, 50, 50, 64, 13, 29, 28, 41, 56, 45, 12, 37, 116, 54, 130, 116, 35, 34, 66, 17, 62, 30, 35, 43, 11, 61, 29, 53, 62, 99, 4, 17, 115, 93, 57, 53, 21, 47, 28, 37, 57, 15, 29, 46, 42, 61, 116, 30, 43, 110, 33, 17, 42, 18, 9, 53, 47, 34, 35, 9, 67, 7] | correct：13% , time：3sec , groups_size：[2, 17, 4, 2, 1, 4, 2, 4, 3, 3, 19, 11, 3, 8, 7, 7, 1, 1, 11, 1, 1, 2, 1, 7, 9, 7, 8, 1, 1, 2, 23, 8, 32, 1, 1, 19, 1, 3, 3, 1, 4, 7, 5, 4, 4, 4, 5, 27, 38, 4, 14, 29, 4, 4, 1, 2, 3, 3, 6, 2, 19, 2, 20, 4, 1, 5, 4, 23, 1, 6, 14, 8, 4, 4, 3, 26, 31, 1, 9, 6, 5, 5, 26, 2, 15, 4, 9, 5, 1, 1, 4, 6, 7, 4, 2, 2, 6, 10, 2, 2] | correct：20% , time：2sec , groups_size：[1, ... , 1] |
| log 3 |  | correct：73% , time：120sec , groups_size：[1018 , 1072 , 915 , 657 , 715] | correct：58% , time：94sec , groups_size：[606, 924, 855, 998, 885, 636, 517, 768, 814, 603] | correct：66% , time：46sec , groups_size：[914, 645, 828, 946, 1050, 757, 688, 821, 800, 616, 733, 752, 878, 654, 559, 893, 838, 941, 1095, 701, 574, 930, 1283, 1009, 768, 754, 686, 974, 728, 967, 532, 868, 1001, 1034, 1070, 430, 893, 752, 599, 511, 456, 747, 1176, 838, 993, 830, 919, 260, 754, 726, 735, 621, 286, 664, 807, 342, 850, 963, 934, 997, 736, 983, 725, 944, 1208, 1069, 886, 1006, 558, 785, 708, 719, 985, 558, 971, 603, 700, 805, 1126, 876, 1130, 793, 1249, 916, 1221, 1106, 752, 784, 800, 959, 1008, 783, 880, 1117, 704, 455, 1130, 790, 616, 840] | correct：15% , time：25sec , groups_size：[110, 115, 183, 125, 391] | correct：23% , time：9sec , groups_size：[306, 272, 309, 41, 227, 234, 151, 290, 317, 141] | correct：20% , time：13sec , groups_size：[132, 328, 186, 295, 109, 207, 308, 134, 331, 174, 102, 142, 249, 269, 335, 249, 326, 81, 166, 270, 177, 212, 252, 193, 401, 371, 198, 190, 174, 172, 198, 181, 167, 245, 76, 177, 230, 168, 152, 64, 212, 63, 255, 78, 96, 243, 154, 37, 242, 118, 375, 353, 206, 53, 243, 307, 237, 137, 244, 198, 63, 473, 242, 96, 64, 142, 243, 179, 107, 197, 110, 283, 173, 109, 279, 391, 124, 174, 111, 175, 198, 127, 382, 305, 123, 314, 121, 137, 178, 236, 232, 84, 174, 123, 193, 198, 273, 179, 116, 156] | correct：8% , time：6sec , groups_size：[13, 52, 31, 10, 16, 29, 23, 11, 121, 85, 63, 44, 14, 65, 36, 14, 11, 16, 114, 18, 121, 22, 26, 25, 45, 72, 6, 26, 54, 64, 48, 89, 36, 66, 27, 19, 53, 57, 14, 69, 24, 22, 13, 48, 26, 10, 50, 90, 12, 27, 60, 111, 18, 34, 46, 22, 27, 46, 114, 64, 49, 9, 33, 13, 58, 29, 36, 60, 29, 51, 105, 25, 35, 31, 87, 19, 35, 45, 104, 72, 2, 71, 40, 20, 75, 59, 53, 43, 48, 32, 99, 56, 13, 58, 37, 34, 13, 48, 67, 83] | correct：11% , time：3sec , groups_size：[9, 4, 1, 7, 6, 2, 16, 8, 1, 1, 20, 1, 3, 7, 2, 16, 3, 1, 28, 3, 6, 38, 3, 2, 7, 6, 34, 7, 2, 3, 6, 24, 32, 5, 17, 21, 3, 23, 9, 6, 3, 9, 6, 3, 1, 11, 6, 3, 3, 7, 7, 7, 1, 5, 1, 2, 2, 6, 2, 3, 7, 3, 1, 4, 3, 8, 3, 7, 3, 4, 4, 2, 1, 4, 1, 4, 3, 38, 1, 3, 5, 4, 12, 4, 4, 2, 8, 3, 2, 10, 4, 2, 13, 2, 3, 15, 3, 6, 1, 1] | correct：15% , time：2sec , groups_size：[1, ... , 1] |
| log 4 |  | correct：83% , time：102sec , groups_size：[558, 648, 913, 748, 765] | correct：78% , time：78sec , groups_size：[890, 1001, 867, 715, 714, 425, 852, 850, 964, 909] | correct：63% , time：43sec , groups_size：[794, 719, 912, 811, 1165, 837, 832, 1117, 319, 674, 837, 914, 542, 870, 240, 875, 1137, 519, 1020, 748, 885, 709, 710, 872, 626, 793, 547, 808, 955, 763, 839, 1062, 714, 940, 771, 1060, 693, 784, 749, 1158, 929, 785, 603, 771, 560, 947, 854, 1028, 1131, 763, 739, 1025, 697, 618, 759, 747, 783, 983, 826, 750, 1095, 902, 1099, 878, 719, 929, 781, 553, 1259, 959, 764, 481, 1060, 1208, 649, 918, 420, 974, 764, 978, 846, 785, 840, 619, 1307, 946, 888, 807, 840, 864, 703, 590, 1004, 751, 1258, 581, 1187, 612, 794, 537] | correct：32% , time：25sec , groups_size：[238, 322, 131, 425, 186] | correct：27% , time：22sec , groups_size：[236, 346, 76, 176, 149, 222, 197, 112, 244, 98] | correct：13% , time：12sec , groups_size：[199, 147, 148, 193, 352, 160, 320, 201, 381, 166, 38, 198, 112, 95, 331, 358, 204, 391, 207, 247, 85, 178, 128, 170, 318, 372, 275, 65, 238, 147, 169, 153, 209, 293, 172, 199, 190, 260, 299, 250, 193, 41, 332, 149, 162, 99, 401, 220, 104, 273, 45, 332, 257, 181, 330, 280, 106, 139, 235, 151, 52, 167, 90, 112, 177, 60, 359, 253, 56, 320, 146, 118, 283, 156, 206, 129, 150, 171, 111, 297, 52, 44, 203, 108, 226, 190, 87, 101, 387, 240, 209, 103, 237, 218, 156, 148, 362, 379, 236, 329] | correct：8% , time：6sec , groups_size：[63, 6, 2, 24, 15, 43, 31, 50, 46, 52, 19, 8, 73, 120, 33, 12, 71, 77, 47, 48, 6, 8, 36, 41, 87, 31, 32, 11, 39, 60, 98, 64, 46, 11, 113, 59, 61, 11, 61, 30, 13, 28, 15, 82, 11, 26, 25, 48, 42, 44, 45, 51, 31, 34, 21, 98, 40, 84, 80, 27, 50, 5, 73, 27, 126, 11, 53, 8, 35, 66, 54, 19, 55, 71, 28, 26, 104, 25, 93, 10, 29, 25, 30, 105, 9, 64, 21, 63, 44, 66, 22, 33, 88, 74, 32, 24, 22, 60, 42, 22] | correct：14% , time：3sec , groups_size：[9, 4, 3, 5, 6, 4, 5, 5, 3, 5, 29, 2, 4, 20, 15, 4, 9, 5, 2, 7, 3, 10, 4, 5, 23, 4, 5, 2, 4, 10, 1, 3, 8, 1, 5, 12, 1, 1, 9, 2, 7, 11, 8, 2, 1, 4, 3, 1, 9, 1, 26, 6, 9, 3, 15, 20, 2, 20, 2, 3, 2, 5, 3, 26, 24, 1, 5, 2, 37, 1, 2, 6, 3, 7, 3, 1, 7, 3, 2, 1, 4, 24, 2, 1, 1, 1, 3, 18, 4, 2, 5, 3, 1, 39, 4, 1, 2, 4, 2, 7] | correct：17% , time：2sec , groups_size：[1, ... , 1] |
| log 5 |  | correct：72% , time：101sec , groups_size：[556, 849, 998, 946, 651] | correct：78% , time：77sec , groups_size：[787, 433, 842, 1311, 929, 1004, 996, 644, 1025, 898] | correct：63% , time：94sec , groups_size：[945, 878, 756, 684, 574, 855, 645, 761, 850, 913, 385, 734, 751, 958, 787, 513, 957, 706, 1061, 619, 950, 653, 644, 880, 985, 985, 1197, 675, 876, 708, 822, 554, 823, 668, 620, 833, 644, 737, 603, 860, 846, 1038, 745, 874, 1020, 684, 1261, 765, 498, 820, 736, 742, 751, 827, 799, 1079, 1336, 410, 970, 735, 1328, 904, 575, 924, 667, 648, 809, 748, 989, 1064, 819, 804, 886, 781, 770, 299, 659, 867, 1000, 847, 948, 861, 956, 998, 826, 780, 860, 853, 573, 964, 1028, 814, 841, 1039, 631, 828, 799, 1051, 775, 1252] | correct：33% , time：21sec , groups_size：[196, 205, 140, 113, 112] | correct：20% , time：15sec , groups_size：[122, 255, 331, 199, 73, 81, 185, 257, 225, 100] | correct：11% , time：9sec , groups_size：[309, 134, 250, 87, 165, 197, 373, 93, 268, 107, 135, 109, 293, 213, 223, 276, 167, 57, 144, 59, 113, 154, 108, 45, 49, 167, 178, 153, 330, 218, 117, 398, 156, 156, 166, 171, 211, 307, 195, 48, 304, 357, 251, 224, 203, 61, 345, 156, 159, 350, 177, 263, 188, 161, 86, 271, 123, 299, 238, 306, 46, 200, 147, 150, 211, 151, 112, 154, 247, 329, 226, 240, 85, 219, 145, 342, 86, 79, 118, 86, 295, 393, 209, 112, 142, 121, 40, 75, 195, 199, 196, 131, 263, 391, 270, 240, 214, 229, 176, 116] | correct：10% , time：5sec , groups_size：[34, 78, 64, 18, 46, 75, 35, 44, 27, 43, 123, 31, 54, 69, 54, 33, 69, 19, 5, 44, 13, 1, 12, 10, 7, 63, 40, 66, 9, 9, 22, 5, 39, 45, 131, 6, 25, 40, 10, 84, 25, 29, 63, 10, 99, 46, 53, 75, 69, 74, 21, 10, 136, 7, 35, 72, 51, 49, 23, 31, 33, 18, 47, 28, 33, 25, 124, 58, 91, 36, 11, 102, 137, 24, 40, 76, 30, 54, 13, 17, 52, 9, 59, 10, 23, 28, 80, 42, 129, 41, 43, 55, 33, 31, 11, 8, 38, 13, 108, 61] | correct：13% , time：3sec , groups_size：[1, 1, 10, 1, 1, 12, 2, 6, 14, 9, 7, 3, 1, 13, 12, 6, 13, 1, 8, 1, 28, 14, 3, 1, 1, 1, 10, 14, 4, 15, 1, 4, 3, 1, 1, 4, 3, 32, 14, 3, 1, 2, 13, 6, 6, 5, 7, 1, 2, 3, 1, 7, 2, 4, 16, 20, 3, 1, 3, 2, 6, 2, 5, 7, 2, 7, 3, 4, 5, 7, 13, 8, 1, 2, 16, 17, 4, 1, 7, 2, 6, 21, 5, 2, 2, 2, 2, 3, 2, 13, 9, 14, 4, 1, 12, 2, 2, 3, 10, 2] | correct：15% , time：3sec , groups_size：[1, ... , 1] |
| total | correct：98% , time：266sec(4 - 5min) , groups_size：[1473] (ALL) | correct：70 - 80% , time：90 - 110sec , groups_size：(500 - 1000) | correct：60 - 75% , time：75 - 85sec , groups_size：(500 - 1000) | correct：60 - 65% , time：45 - 60sec , groups_size：(500 - 1000) | correct：20 - 30% , time：20 - 30sec , groups_size：(100 - 300) | correct：20 - 25% , time：15sec , groups_size：(100 - 300) | correct：10 - 25% , time：10 - 15sec , groups_size：(100 - 300) | correct：10% , time：6sec , groups_size：(10 - 100) | correct：13% , time：3sec , groups_size：(1 - 20) | correct：10 - 15% , time：2sec , groups_size：(1) |

-----